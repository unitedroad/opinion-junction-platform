(function(d){var b;function a(l){var k=l.match((/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/));return k&&k[2].length===11?k[2]:false}function g(k,l){var m=a(k);if(k&&m){k="https://www.youtube.com/"+(l?"embed/":"v/")+a(k)}return k}function f(m,l,k,o){var p,n;if(o){p='width="'+l+'" height="'+k+'"';n='<iframe src="'+o+'" '+p+' frameborder="0" allowfullscreen>&nbsp;</iframe>'}return n}function i(){var s,r="",q=d("#video").is(":checked"),k=d("#youtubeAutoplay").is(":checked"),l=d("#youtubeREL").is(":checked"),o=d("#youtubeHD").is(":checked"),m=d("#youtubeWidth").val(),p=d("#youtubeHeight").val(),n=g(d("#youtubeID").val(),q);if(k){r+="&amp;autoplay=1"}if(l){r+="&amp;rel=0"}if(o){r+="&amp;hd=1"}if(n){s=f(q,m,p,n+(q?"":r))}return s}function e(){d("#preview").html(f(true,420,315,g(d("#youtubeID").val())))}function j(k){clearTimeout(b);b=setTimeout(e,k||1000)}function c(){var k=i();if(k){parent.tinymce.activeEditor.insertContent(k)}parent.tinymce.activeEditor.windowManager.close()}function h(){if(d("#preview").length){d("#youtubeID").keypress(function(){j()}).change(function(){j(100)})}}d(function(){var k={youtubeurl:parent.tinymce.util.I18n.translate("Youtube URL"),youtubeID:parent.tinymce.util.I18n.translate("Youtube ID"),youtubeWidth:parent.tinymce.util.I18n.translate("width"),youtubeHeight:parent.tinymce.util.I18n.translate("height"),youtubeAutoplay:parent.tinymce.util.I18n.translate("autoplay"),youtubeHD:parent.tinymce.util.I18n.translate("HD video"),youtubeREL:parent.tinymce.util.I18n.translate("Related video"),HTML5:parent.tinymce.util.I18n.translate("html5"),Insert:parent.tinymce.util.I18n.translate("Insert")};d.get("view/forms.html",function(l){d("#template-container").append(Mustache.render(l,k));h();d("#insert-btn").on("click",c)})})}(jQuery));