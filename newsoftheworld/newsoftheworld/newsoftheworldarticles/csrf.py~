from django.http import HttpResponseForbidden
from django.template import Context, Template
from django.conf import settings

def csrf_failure(request, reason=""):
    """
    view used when request fails CSRF protection 
    """
    from django.middleware.csrf import REASON_NO_REFERER
    t = Template(CSRF_FAILURE_TEMPLATE)
    c = Context({'DEBUG': settings.DEBUG,
                 'reason': reason,
                 'no_referer': reason == REASON_NO_REFERER
                 })
    return HttpResponseForbidden(t.render(c), content_type='text/html')
